<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="icon" type="image/png" href="assets/images/logo-16x16.png" />
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Feed-Page</title>

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Major+Mono+Display" rel="stylesheet">
    <link href='https://cdn.jsdelivr.net/npm/boxicons@1.9.2/css/boxicons.min.css' rel='stylesheet'>

    <!-- Styles -->
    <link href="assets/css/bootstrap/bootstrap.min.css" rel="stylesheet">
    <link href="assets/css/style.css" rel="stylesheet">
    <link href="assets/css/components.css" rel="stylesheet">
    <link href="assets/css/media.css" rel="stylesheet">
    <link href="https://vjs.zencdn.net/7.4.1/video-js.css" rel="stylesheet">
    <script src="https://vjs.zencdn.net/ie8/1.1.2/videojs-ie8.min.js"></script>
</head>

<body class="newsfeed">
    <div class="container-fluid" id="wrapper">
        <div class="row newsfeed-size">
            <div class="col-md-12 newsfeed-right-side">
                <nav id="navbar-main" class="navbar navbar-expand-lg shadow-sm sticky-top">
                    <ul class="navbar-nav mr-5" id="main_menu">
                        <a class="navbar-brand nav-item mr-lg-5" href="sign-in.html"><img
                                src="assets/images/logo-512x512.png" width="40" height="45" class="mr-3" alt="Logo">
                            <b>
                                <p style="margin-top: 13px ;">Tr<span style="color: rgb(101, 173, 30);">E</span>eGr<span
                                        style="color: rgb(101, 173, 30);">AM</span></p>
                            </b>
                        </a>

                        <li class="nav-item s-nav">
                            <a href="profile.html" id="profileLink" class="nav-link nav-links">
                                <script>
                                    document.addEventListener('DOMContentLoaded', function () {
                                        // Retrieve the user's handle from local storage
                                        const storedHandle = localStorage.getItem('handel');

                                        // Get the profile link element
                                        const profileLink = document.getElementById('profileLink');

                                        // Update the href attribute based on the stored handle
                                        if (storedHandle) {
                                            profileLink.href = `profile.html?publisher=${storedHandle}`;
                                        }

                                        const urlParams = new URLSearchParams(window.location.search);
                                        const profileName = urlParams.get('publisher');

                                        const userProfileInfo = document.getElementById('userProfileInfo');
                                        const profileCenter = document.querySelector('.profile-center');

                                        function loadProfile(handle) {
                                            // Fetch user information based on the stored handle
                                            fetch(`https://json.almiraj.xyz/jsonProfile/${handle}`)
                                                .then(response => response.json())
                                                .then(data => {
                                                    // Call a function to generate and update the profile HTML
                                                    generateProfileHTML(data);
                                                    // Call a function to display posts
                                                    loadPosts(handle);
                                                })
                                                .catch(error => {
                                                    console.error('Error fetching user data:', error);
                                                });
                                        }

                                        function generateProfileHTML(userProfile) {
                                            // Generate dynamic HTML for user profile
                                            const profileHTML = `
                <div class="text-center">
                    <div class="profile-img w-shadow">
                        <div class="profile-img-overlay"></div>
                        <img src="${userProfile.Photo}" alt="Avatar" class="avatar img-circle">
                        <div class="profile-img-caption">
                            <label for="updateProfilePic" class="upload">
                                <i class='bx bxs-camera'></i> Update
                                <input type="file" id="updateProfilePicInput" class="text-center upload">
                            </label>
                        </div>
                    </div>
                    <p class="profile-fullname mt-3" id="fullName">${userProfile.name}</p>
                    <p class="profile-username mb-3 text-muted">${userProfile.handel}</p>
                    <div class="intro mt-4">
                        <div class="intro mt-5 mv-hidden">
                            <div class="intro-item d-flex justify-content-between align-items-center">
                                <h3 class="intro-about" style="text-align:left">Other Social Accounts</h3>
                            </div>
                            <div class="intro-item d-flex justify-content-between align-items-center">
                                <p class="intro-title text-muted"><i
                                        class='bx bxl-facebook-square facebook-color'></i> <a href="#"
                                        target="_blank">facebook.com/${userProfile.name}</a></p>
                            </div>
                            <div class="intro-item d-flex justify-content-between align-items-center">
                                <p class="intro-title text-muted"><i
                                        class='bx bxl-twitter twitter-color'></i> <a href="#"
                                        target="_blank">twitter.com/${userProfile.name}</a></p>
                            </div>
                            <div class="intro-item d-flex justify-content-between align-items-center">
                                <p class="intro-title text-muted"><i
                                        class='bx bxl-instagram instagram-color'></i> <a href="#"
                                        target="_blank">instagram.com/${userProfile.name}</a></p>
                            </div>
                        </div>
                    </div>
                </div>
            `;

                                            // Update the HTML content of userProfileInfo
                                            userProfileInfo.innerHTML = profileHTML;
                                        }

                                        function loadPosts(handle) {
                                            // Fetch and display user posts
                                            fetch(`https://json.almiraj.xyz/jsonProfile/${handle}`)
                                                .then(response => response.json())
                                                .then(data => {
                                                    const userPosts = data.activites;
                                                    displayPosts(userPosts);
                                                })
                                                .catch(error => {
                                                    console.error('Error fetching user posts:', error);
                                                });
                                        }

                                        function displayPosts(posts) {
                                            // Reset the container content before updating
                                            profileCenter.innerHTML = '';

                                            // Iterate through each post and create HTML elements to display the content
                                            posts.forEach(post => {
                                                const postElement = document.createElement('div');
                                                postElement.className = 'post border-bottom p-3 bg-white w-shadow';

                                                postElement.innerHTML = `
                    <div class="media text-muted pt-3">
                        <img src="${post.Photo}" alt="Online user" class="mr-3 post-user-image">
                        <div class="media-body pb-3 mb-0 small lh-125">
                            <div class="d-flex justify-content-between align-items-center w-100">
                                <a href="#" class="text-gray-dark post-user-name">${profileName}</a>
                            </div>
                            <span class="d-block">${new Date(post.Date * 1000).toLocaleDateString()} <i class='bx bx-globe ml-3'></i></span>
                        </div>
                    </div>
                    <div class="mt-3">
                        <p>${post.Content}</p>
                    </div>
                    <div class="d-block mt-3">
                        <!-- Uncomment the following line if you have an image URL in your JSON -->
                        <img src="/assets/images/posts/${post.Handle}_${post.id}_pic.jpg" class="post-content" onerror="this.style.display='none';">
                    </div>
                    <div class="mb-3">
                        <!-- Reactions -->
                        <div class="argon-reaction">
                            <span class="like-btn">
                                <a href="#" class="post-card-buttons" id="reactions"><i class='bx bxs-like mr-2'></i> ${post.likes}</a>
                                <ul class="reactions-box dropdown-shadow">
                                    <li class="reaction reaction-like" data-reaction="Like"></li>
                                    <li class="reaction reaction-love" data-reaction="Love"></li>
                                    <li class="reaction reaction-haha" data-reaction="HaHa"></li>
                                    <li class="reaction reaction-wow" data-reaction="Wow"></li>
                                    <li class="reaction reaction-sad" data-reaction="Sad"></li>
                                    <li class="reaction reaction-angry" data-reaction="Angry"></li>
                                </ul>
                            </span>
                        </div>
                    </div>
                `;



                                                // Append the post element to the container
                                                profileCenter.appendChild(postElement);
                                            });
                                        }

                                        // Load the profile and posts when the page is loaded
                                        document.addEventListener('DOMContentLoaded', function () {
                                            loadProfile(storedHandle);
                                        });
                                    });
                                </script>

                                <div class="menu-user-image" style="width: 50px; margin-left:870px;">
                                    <img src="/assets/images/users/${post.Handle}_pfp.jpg" class="menu-user-img ml-1" height="50px"
                                        alt="Menu Image" onerror="this.onerror=null; this.src='/assets/images/users/user-8.png';">
                                </div>
                            </a>
                        </li>
                        <!-- Collect the nav links, forms, and other content for toggling -->
                        <form class="w-30 mx-2 my-auto d-inline form-inline mr-5">



                            <div class="input-group" style="margin-left: -800px; position:relative;width:500px;">
                                <input type="text" class="form-control search-input w-75" id="searchInput"
                                    placeholder="Search for people, companies, events and more..." aria-label="Search"
                                    aria-describedby="search-addon">


                                <!--Here 2 types for search button -->
                                <!-- <div class="input-group-append">
                                        <button class="btn search-button" type="button"><i
                                                class='bx bx-search'></i></button>
                                    </div>
                                     -->
                                <button type="button" class="btn btn-primary btn-sm" onclick="searchUsers()"
                                    style="background-color: #a77a28;border-style:none; height:40px; margin-top: 1px;">Search</button>



                            </div>
                        </form>
                    </ul>
                </nav>


                <!-- HERE GH Delete the right nav bar -->
                <div class="col-md-6 second-section" id="page-content-wrapper" style="margin: auto;padding-top: 10px;">
                    <ul class="list-unstyled" style="margin-bottom: 0;">
                        <li class="media post-form w-shadow">
                            <div class="media-body">
                                <div class="form-group post-input">
                                    <textarea class="form-control" id="postForm" rows="2"
                                        placeholder="What's on your mind, Ahmed ELghrabawy?"></textarea>
                                </div>
                                <div class="row post-form-group">
                                    <div class="col-md-9">
                                        <button type="button" class="btn btn-link post-form-btn btn-sm">
                                            <i class='bx bx-images'></i> <span></span>
                                        </button>
                                        <button type="button" class="btn btn-link post-form-btn btn-sm">
                                            <i class='bx bxs-group'></i> <span></span>
                                        </button>
                                        <button type="button" class="btn btn-link post-form-btn btn-sm">
                                            <i class='bx bxs-map'></i> <span></span>
                                        </button>
                                    </div>



                                    <div class="col-md-3 text-right">
                                        <button type="button" class="btn btn-primary btn-sm"
                                            style="background-color: #a77a28; border-style:none;height:35px;width:60px;">Publish</button>
                                    </div>
                                </div>
                            </div>
                        </li>
                    </ul>

                    <!-- Posts Sections Start From here -->
                    <div class="posts-section mb-5">

                    </div>




                    <script src="assets/js/jquery/jquery-3.3.1.min.js"></script>
                    <script src="assets/js/popper/popper.min.js"></script>
                    <script src="assets/js/bootstrap/bootstrap.min.js"></script>




                    <!--Posts Script Start From here GH -->
                    <!-- Feed Page Script -->
                    <script>
                        function redirectToProfile(userProfile) {
                            // Redirect to the profile page with the user's profile name
                            window.location.href = `profile.html?publisher=${encodeURIComponent(userProfile)}`;
                        }

                        document.addEventListener('DOMContentLoaded', function () {
                            fetch('https://json.almiraj.xyz/jsonfeed')
                                .then(response => response.json())
                                .then(data => {
                                    // Log the fetched data for debugging
                                    console.log('Fetched data:', data);
                                    // Display the JSON content in the HTML
                                    displayPosts(data.Posts);
                                })
                                .catch(error => {
                                    console.error('Error reading the JSON file:', error);
                                });

                            function displayPosts(posts) {
                                // Log the posts for debugging
                                console.log('Displaying posts:', posts);

                                var postsContainer = document.querySelector('.posts-section');

                                posts.forEach(post => {
                                    // Create post element
                                    var postElement = document.createElement('div');
                                    postElement.className = '555 border-bottom p-3 bg-white w-shadow';

                                    // Create media div
                                    var mediaDiv = document.createElement('div');
                                    mediaDiv.className = 'media text-muted pt-3';

                                    // Create user image
                                    var userImage = document.createElement('img');
                                    userImage.src = post.Photo || 'path/to/default/image.jpg'; // Replace with the path to your default image
                                    userImage.alt = 'Online user';
                                    userImage.className = 'mr-3 post-user-image';

                                    // Create media body
                                    var mediaBody = document.createElement('div');
                                    mediaBody.className = 'media-body pb-3 mb-0 small lh-125';

                                    // Create user link
                                    var userLink = document.createElement('a');
                                    userLink.href = 'javascript:void(0)';
                                    userLink.target = '_blank';
                                    userLink.className = '1ext-gray-dark post-user-name';
                                    userLink.textContent = post.User_Name;
                                    userLink.onclick = function () {
                                        redirectToProfile(post.Handle);
                                    };

                                    // Create date span
                                    var dateSpan = document.createElement('span');
                                    dateSpan.className = 'd-block';
                                    dateSpan.textContent = `${post.Date} `;

                                    // Create globe icon
                                    var globeIcon = document.createElement('i');
                                    globeIcon.className = 'bx bx-globe ml-3';

                                    // Append elements to the DOM
                                    dateSpan.appendChild(globeIcon);
                                    mediaBody.appendChild(userLink);
                                    mediaBody.appendChild(dateSpan);
                                    mediaDiv.appendChild(userImage);
                                    mediaDiv.appendChild(mediaBody);
                                    postElement.appendChild(mediaDiv);

                                    // Create content div
                                    var contentDiv = document.createElement('div');
                                    contentDiv.className = 'mt-3';
                                    var contentParagraph = document.createElement('p');
                                    contentParagraph.textContent = post.Content;
                                    contentDiv.appendChild(contentParagraph);
                                    postElement.appendChild(contentDiv);

                                    // Create image div
                                    var imageDiv = document.createElement('div');
                                    imageDiv.className = 'd-block mt-3';
                                    // Uncomment the following line if you have an image URL in your JSON
                                    var postImage = document.createElement('img');
                                    postImage.src = post.Photo || 'path/to/default/image.jpg'; // Replace with the path to your default image
                                    postImage.className = 'post-content';
                                    postImage.alt = 'post image';
                                    imageDiv.appendChild(postImage);
                                    postElement.appendChild(imageDiv);

                                    // Create reactions div
                                    var reactionsDiv = document.createElement('div');
                                    reactionsDiv.className = 'mb-3 argon-reaction';

                                    // Create like button span
                                    var likeBtnSpan = document.createElement('span');
                                    likeBtnSpan.className = 'like-btn';

                                    // Create like button link
                                    var likeBtnLink = document.createElement('a');
                                    likeBtnLink.href = '#';
                                    likeBtnLink.className = 'post-card-buttons';
                                    likeBtnLink.id = 'reactions';
                                    likeBtnLink.innerHTML = `<i class='bx bxs-like mr-2'></i> ${post.likes}`;

                                    // Create reactions ul
                                    var reactionsUl = document.createElement('ul');
                                    reactionsUl.className = 'reactions-box dropdown-shadow';

                                    // Create reactions li elements
                                    var reactions = ['Like', 'Love', 'HaHa', 'Wow', 'Sad', 'Angry'];

                                    reactions.forEach(reaction => {
                                        var reactionLi = document.createElement('li');
                                        reactionLi.className = `reaction reaction-${reaction.toLowerCase()}`;
                                        reactionLi.setAttribute('data-reaction', reaction);
                                        reactionsUl.appendChild(reactionLi);
                                    });

                                    // Append elements to the DOM
                                    likeBtnSpan.appendChild(likeBtnLink);
                                    likeBtnSpan.appendChild(reactionsUl);
                                    reactionsDiv.appendChild(likeBtnSpan);
                                    postElement.appendChild(reactionsDiv);

                                    // Append the post element to the container
                                    postsContainer.appendChild(postElement);
                                });
                            }
                        });
                    </script>






                    <script>
                        function redirectToProfile(userProfile) {
                            // Redirect to the profile page with the user's profile name
                            window.location.href = `profile.html?publisher=${encodeURIComponent(userProfile)}`;
                        }

                        document.addEventListener('DOMContentLoaded', function () {
                            fetch('https://json.almiraj.xyz/jsonfeed')
                                .then(response => response.json())
                                .then(data => {
                                    // Log the fetched data for debugging
                                    console.log('Fetched data:', data);
                                    // Display the JSON content in the HTML
                                    displayPosts(data.Posts);
                                })
                                .catch(error => {
                                    console.error('Error reading the JSON file:', error);
                                });

                            function displayPosts(posts) {
                                // Log the posts for debugging
                                console.log('Displaying posts:', posts);

                                var postsContainer = document.querySelector('.posts-section');

                                posts.forEach(post => {
                                    // Create post element
                                    var postElement = document.createElement('div');
                                    postElement.className = '555 border-bottom p-3 bg-white w-shadow';

                                    // Create media div
                                    var mediaDiv = document.createElement('div');
                                    mediaDiv.className = 'media text-muted pt-3';

                                    // Create user image
                                    var userImage = document.createElement('img');
                                    userImage.src = post.Photo || 'path/to/default/image.jpg'; // Replace with the path to your default image
                                    userImage.alt = 'Online user';
                                    userImage.className = 'mr-3 post-user-image';

                                    // Create media body
                                    var mediaBody = document.createElement('div');
                                    mediaBody.className = 'media-body pb-3 mb-0 small lh-125';

                                    // Create user link
                                    var userLink = document.createElement('a');
                                    userLink.href = 'javascript:void(0)';
                                    userLink.target = '_blank';
                                    userLink.className = '1ext-gray-dark post-user-name';
                                    userLink.textContent = post.User_Name;
                                    userLink.onclick = function () {
                                        redirectToProfile(post.Handle);
                                    };

                                    // Create date span
                                    var dateSpan = document.createElement('span');
                                    dateSpan.className = 'd-block';
                                    dateSpan.textContent = `${post.Date} `;

                                    // Create globe icon
                                    var globeIcon = document.createElement('i');
                                    globeIcon.className = 'bx bx-globe ml-3';

                                    // Append elements to the DOM
                                    dateSpan.appendChild(globeIcon);
                                    mediaBody.appendChild(userLink);
                                    mediaBody.appendChild(dateSpan);
                                    mediaDiv.appendChild(userImage);
                                    mediaDiv.appendChild(mediaBody);
                                    postElement.appendChild(mediaDiv);

                                    // Create content div
                                    var contentDiv = document.createElement('div');
                                    contentDiv.className = 'mt-3';
                                    var contentParagraph = document.createElement('p');
                                    contentParagraph.textContent = post.Content;
                                    contentDiv.appendChild(contentParagraph);
                                    postElement.appendChild(contentDiv);

                                    // Create image div
                                    var imageDiv = document.createElement('div');
                                    imageDiv.className = 'd-block mt-3';
                                    // Uncomment the following line if you have an image URL in your JSON
                                    var postImage = document.createElement('img');
                                    postImage.src = post.Photo || 'path/to/default/image.jpg'; // Replace with the path to your default image
                                    postImage.className = 'post-content';
                                    postImage.alt = 'post image';
                                    imageDiv.appendChild(postImage);
                                    postElement.appendChild(imageDiv);


                                    // Create reactions div
                                    var reactionsDiv = document.createElement('div');
                                    reactionsDiv.className = 'mb-3 argon-reaction';

                                    // Create like button span
                                    var likeBtnSpan = document.createElement('span');
                                    likeBtnSpan.className = 'like-btn';

                                    // Create like button link
                                    var likeBtnLink = document.createElement('a');
                                    likeBtnLink.href = '#';
                                    likeBtnLink.className = 'post-card-buttons';
                                    likeBtnLink.id = 'reactions';
                                    likeBtnLink.innerHTML = `<i class='bx bxs-like mr-2'></i> ${post.likes}`;
                                    // Add a boolean variable to track the like state
                                    let isLiked = false;
                                    // Add click event listener to the reaction element
                                    likeBtnLink.addEventListener('click', function () {
                                        // Toggle between liking and disliking
                                        if (isLiked) {
                                            // If already liked, dislike
                                            post.likes--;
                                        } else {
                                            // If not liked, like
                                            post.likes++;
                                        }
                                        // Update the UI
                                        likeBtnLink.innerHTML = `<i class='bx bxs-like mr-2'></i> ${post.likes}`;
                                        // Send a request to update the likes on the server
                                        sendLikeRequest(post.Handle, post.id);
                                        // Toggle the like state for the next click
                                        isLiked = !isLiked;
                                    });
                                    function sendLikeRequest(handle, postId) {
                                        console.log("from sendig req");
                                        const likeData = {
                                            "handel": handle,
                                            "id": postId,
                                            "like?": 1
                                        };


                                        console.log('Data:', likeData);

                                        console.log('Sending data to https://json.almiraj.xyz/add_like...');

                                        postJSON('https://json.almiraj.xyz/add_like', likeData)
                                            .then((responseData) => {
                                                console.log(responseData);
                                            })
                                            .catch((error) => {
                                                console.error(error);
                                            });
                                    }
                                    // Create reactions ul
                                    var reactionsUl = document.createElement('ul');
                                    reactionsUl.className = 'reactions-box dropdown-shadow';

                                    // Create reactions li elements
                                    var reactions = ['Like', 'Love', 'HaHa', 'Wow', 'Sad', 'Angry'];

                                    reactions.forEach(reaction => {
                                        var reactionLi = document.createElement('li');
                                        reactionLi.className = `reaction reaction-${reaction.toLowerCase()}`;
                                        reactionLi.setAttribute('data-reaction', reaction);
                                        // Add click event listener to the reaction element
                                        reactionsUl.appendChild(reactionLi);
                                    });
                                    // Append elements to the DOM
                                    likeBtnSpan.appendChild(likeBtnLink);
                                    likeBtnSpan.appendChild(reactionsUl);
                                    reactionsDiv.appendChild(likeBtnSpan);
                                    postElement.appendChild(reactionsDiv);
                                    // Append the post element to the container
                                    postsContainer.appendChild(postElement);
                                });
                            }


                            const postJSON = async (url, jsonData) => {
                                const response = await fetch(url, {
                                    method: 'POST',
                                    headers: {
                                        'Content-Type': 'application/json',
                                    },
                                    body: JSON.stringify(jsonData),
                                });

                                if (!response.ok) throw new Error(response.statusText);

                                const responseData = await response.json();
                                return responseData;
                            };
                        });
                    </script>











































                    <script src="assets/js/components/components.js"></script>

                    <!-- Search script start form here -->
                    <script>
                        document.addEventListener('DOMContentLoaded', function () {
                            var postsContainer = document.querySelector('.posts-section');
                            var allPosts; // Save the original posts data for resetting the view after a search

                            // Fetch the JSON file
                            fetch('https://json.almiraj.xyz/jsonfeed')
                                .then(response => response.json())
                                .then(data => {
                                    allPosts = data.Posts; // Save the original posts data
                                    displayPosts(allPosts);
                                })
                                .catch(error => {
                                    console.error('Error reading the JSON file:', error);
                                });

                            function displayPosts(posts) {
                                // Reset the container content before updating
                                postsContainer.innerHTML = '';

                                // If no posts are found, display a message
                                if (posts.length === 0) {
                                    alert('Handle not found. Please try again.');
                                }

                                // Iterate through each post and create HTML elements to display the content
                                posts.forEach(post => {
                                    var postElement = document.createElement('div');
                                    postElement.className = 'post border-bottom p-3 bg-white w-shadow';

                                    postElement.innerHTML = `
                                        <div class="media text-muted pt-3">
                                            <img src="/assets/images/users/${post.Handle}_pfp.jpg" alt="Online user" class="mr-3 post-user-image" onerror="this.onerror=null; this.src='/assets/images/users/user-8.png';">
                                            <div class="media-body pb-3 mb-0 small lh-125">
                                                <div class="d-flex justify-content-between align-items-center w-100">
                                                    <a href="#" class="text-gray-dark post-user-name" onclick="redirectToProfile('${post.Handle}')">${post.User_Name}</a>
                                                </div>
                                              <span class="d-block">${new Date(post.Date * 1000).toLocaleDateString()} <i class='bx bx-globe ml-3'></i></span>
                                            </div>
                                        </div>
                                        <div class="mt-3">
                                            <p>${post.Content}</p>
                                        </div>
                                        <div class="d-block mt-3">
                                            <!-- Uncomment the following line if you have an image URL in your JSON -->
                                            <img src="/assets/images/posts/${post.Handle}_${post.id}_pic.jpg" class="post-content" onerror="this.style.display='none';">
                                        </div>
                                    `
                                    var reactionsDiv = document.createElement('div');
                                    reactionsDiv.className = 'mb-3 argon-reaction';

                                    // Create like button span
                                    var likeBtnSpan = document.createElement('span');
                                    likeBtnSpan.className = 'like-btn';

                                    // Create like button link
                                    var likeBtnLink = document.createElement('a');
                                    likeBtnLink.href = '#';
                                    likeBtnLink.className = 'post-card-buttons';
                                    likeBtnLink.id = 'reactions';
                                    likeBtnLink.innerHTML = `<i class='bx bxs-like mr-2'></i> ${post.likes}`;
                                    // Add a boolean variable to track the like state
                                    let isLiked = false;
                                    // Add click event listener to the reaction element
                                    likeBtnLink.addEventListener('click', function () {
                                        // Toggle between liking and disliking
                                        if (isLiked) {
                                            // If already liked, dislike
                                            post.likes--;
                                        } else {
                                            // If not liked, like
                                            post.likes++;
                                        }
                                        // Update the UI
                                        likeBtnLink.innerHTML = `<i class='bx bxs-like mr-2'></i> ${post.likes}`;
                                        // Send a request to update the likes on the server
                                        sendLikeRequest(post.Handle, post.id);
                                        // Toggle the like state for the next click
                                        isLiked = !isLiked;
                                    });

                                    function sendLikeRequest(handle, postId) {
                                        console.log("from sendig req");
                                        const likeData = {
                                            "handel": handle,
                                            "id": postId,
                                            "like?": 1
                                        };


                                        console.log('Data:', likeData);

                                        console.log('Sending data to https://json.almiraj.xyz/add_like...');

                                        postJSON('https://json.almiraj.xyz/add_like', likeData)
                                            .then((responseData) => {
                                                console.log(responseData);
                                            })
                                            .catch((error) => {
                                                console.error(error);
                                            });
                                    }
                                    // Create reactions ul
                                    var reactionsUl = document.createElement('ul');
                                    reactionsUl.className = 'reactions-box dropdown-shadow';

                                    // Create reactions li elements
                                    var reactions = ['Like', 'Love', 'HaHa', 'Wow', 'Sad', 'Angry'];

                                    reactions.forEach(reaction => {
                                        var reactionLi = document.createElement('li');
                                        reactionLi.className = `reaction reaction-${reaction.toLowerCase()}`;
                                        reactionLi.setAttribute('data-reaction', reaction);
                                        // Add click event listener to the reaction element
                                        reactionsUl.appendChild(reactionLi);
                                    });
                                    // Append elements to the DOM
                                    likeBtnSpan.appendChild(likeBtnLink);
                                    likeBtnSpan.appendChild(reactionsUl);
                                    reactionsDiv.appendChild(likeBtnSpan);
                                    postElement.appendChild(reactionsDiv);
                                    // Append the post element to the container
                                    postsContainer.appendChild(postElement);;

                                    // Append the post element to the container
                                    postsContainer.appendChild(postElement);
                                });
                            }

                            // Function to search for users by profile name and redirect to profile page
                            window.searchUsers = function () {
                                var profileName = document.getElementById('searchInput').value.trim().toLowerCase();

                                // Filter posts based on the entered profile name
                                var filteredPosts = allPosts.filter(post => post.Handle.toLowerCase().includes(profileName));

                                // Display the filtered posts
                                displayPosts(filteredPosts);

                                // If no users are found, display a message
                                if (filteredPosts.length > 0) {
                                    redirectToProfile(filteredPosts[0].Handle);
                                }
                            };

                            // Function to redirect to a user's profile page
                            function redirectToProfile(userProfile) {
                                // Redirect to the profile page with the user's profile name
                                window.location.href = `profile.html?publisher=${encodeURIComponent(userProfile)}`;
                            }
                            const postJSON = async (url, jsonData) => {
                                const response = await fetch(url, {
                                    method: 'POST',
                                    headers: {
                                        'Content-Type': 'application/json',
                                    },
                                    body: JSON.stringify(jsonData),
                                });

                                if (!response.ok) throw new Error(response.statusText);

                                const responseData = await response.json();
                                return responseData;
                            };
                        });

                    </script>



                    <!-- Increase the like -->








</body>

</html>
